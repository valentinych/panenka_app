# üìä –ê–Ω–∞–ª–∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–∞ Heroku

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ª–æ–∫–∞–ª—å–Ω–∞—è)
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **SQLite** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ buzzer-–ª–æ–±–±–∏:

#### –¢–∞–±–ª–∏—Ü–∞ `lobbies`
```sql
CREATE TABLE lobbies (
    code TEXT PRIMARY KEY,           -- –ö–æ–¥ –ª–æ–±–±–∏ (4 —Å–∏–º–≤–æ–ª–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä "ABCD")
    host_id TEXT NOT NULL,          -- UUID —Ö–æ—Å—Ç–∞
    host_name TEXT NOT NULL,        -- –ò–º—è —Ö–æ—Å—Ç–∞
    host_token TEXT NOT NULL,       -- –¢–æ–∫–µ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ö–æ—Å—Ç–∞
    created_at REAL NOT NULL,       -- –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è (Unix timestamp)
    updated_at REAL NOT NULL,       -- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    host_seen REAL NOT NULL,        -- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ö–æ—Å—Ç–∞
    locked INTEGER NOT NULL,        -- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ –ª–æ–±–±–∏ (0/1)
    buzz_order TEXT NOT NULL        -- JSON –º–∞—Å—Å–∏–≤ –ø–æ—Ä—è–¥–∫–∞ –Ω–∞–∂–∞—Ç–∏–π buzzer
)
```

#### –¢–∞–±–ª–∏—Ü–∞ `players`
```sql
CREATE TABLE players (
    id TEXT PRIMARY KEY,            -- UUID –∏–≥—Ä–æ–∫–∞
    lobby_code TEXT NOT NULL,       -- –ö–æ–¥ –ª–æ–±–±–∏ (–≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á)
    name TEXT NOT NULL,             -- –ò–º—è –∏–≥—Ä–æ–∫–∞
    joined_at REAL NOT NULL,        -- –í—Ä–µ–º—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    last_seen REAL NOT NULL,        -- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    buzzed_at REAL,                 -- –í—Ä–µ–º—è –Ω–∞–∂–∞—Ç–∏—è buzzer (–º–æ–∂–µ—Ç –±—ã—Ç—å NULL)
    FOREIGN KEY(lobby_code) REFERENCES lobbies(code) ON DELETE CASCADE
)
```

### üìÅ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **–õ–æ–∫–∞–ª—å–Ω–æ**: `app/lobbies.sqlite3`
- **–ù–∞ Heroku**: Ephemeral filesystem (–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)
- **–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è**: `PANENKA_LOBBY_DB` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## üîÑ –ö–∞–∫ –Ω–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–±–±–∏
```python
lobby = {
    "code": "ABCD",                    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ
    "host_id": str(uuid4()),           # UUID —Ö–æ—Å—Ç–∞
    "host_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",   # –ò–∑ session
    "host_token": secrets.token_urlsafe(16),
    "created_at": time.time(),
    "updated_at": time.time(),
    "host_seen": time.time(),
    "locked": False,
    "players": {},
    "buzz_order": []
}
```

### 2. –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤
```python
player = {
    "id": str(uuid4()),
    "name": "–ò–º—è –∏–≥—Ä–æ–∫–∞",
    "joined_at": time.time(),
    "last_seen": time.time(),
    "buzzed_at": None  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ buzzer
}
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
- **–õ–æ–±–±–∏ –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑**: 60 –º–∏–Ω—É—Ç (3600 —Å–µ–∫—É–Ω–¥)
- **–ò–≥—Ä–æ–∫–∏ –∏—Å—Ç–µ–∫–∞—é—Ç —á–µ—Ä–µ–∑**: 3 –º–∏–Ω—É—Ç—ã (180 —Å–µ–∫—É–Ω–¥) –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –∫ API

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –Ω–∞ Heroku

### üÜì –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ë–ï–°–ü–õ–ê–¢–ù–û)
```
Dyno: Eco (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
- 1000 —á–∞—Å–æ–≤ –≤ –º–µ—Å—è—Ü –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –ó–∞—Å—ã–ø–∞–µ—Ç –ø–æ—Å–ª–µ 30 –º–∏–Ω—É—Ç –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ü—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ (~10-30 —Å–µ–∫—É–Ω–¥)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: 512 MB RAM

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: SQLite (—Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)
- –ë–ï–°–ü–õ–ê–¢–ù–û
- –ù–û: –î–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ dyno!
```

### ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö
**SQLite –Ω–∞ Heroku –ù–ï –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞!**
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ dyno –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è
- –ü—Ä–∏ –∑–∞—Å—ã–ø–∞–Ω–∏–∏/–ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç —Ç–µ—Ä—è—Ç—å—Å—è

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. üíæ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

#### Heroku Postgres (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
# –î–æ–±–∞–≤–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω Postgres
heroku addons:create heroku-postgresql:essential-0 -a panenka-live

# –°—Ç–æ–∏–º–æ—Å—Ç—å: $5/–º–µ—Å—è—Ü
# –í–∫–ª—é—á–∞–µ—Ç: 1GB —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, 20 –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
```

#### Heroku Redis (–¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
```bash
# –î–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ª–æ–±–±–∏
heroku addons:create heroku-redis:mini -a panenka-live

# –°—Ç–æ–∏–º–æ—Å—Ç—å: $3/–º–µ—Å—è—Ü
# –í–∫–ª—é—á–∞–µ—Ç: 25MB –ø–∞–º—è—Ç–∏
```

### 2. üöÄ –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### Basic Dyno (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
```bash
heroku ps:scale web=1:basic -a panenka-live

# –°—Ç–æ–∏–º–æ—Å—Ç—å: $7/–º–µ—Å—è—Ü
# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
# - –ù–µ –∑–∞—Å—ã–ø–∞–µ—Ç
# - 512 MB RAM
# - –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```

#### Standard-1X Dyno (–¥–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏)
```bash
heroku ps:scale web=1:standard-1x -a panenka-live

# –°—Ç–æ–∏–º–æ—Å—Ç—å: $25/–º–µ—Å—è—Ü
# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
# - 512 MB RAM
# - –ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥
# - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```

## üìà –°—Ü–µ–Ω–∞—Ä–∏–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏

### üÜì –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ç–µ–∫—É—â–∞—è)
```
Eco Dyno: $0/–º–µ—Å—è—Ü
SQLite: $0/–º–µ—Å—è—Ü
–ò–¢–û–ì–û: $0/–º–µ—Å—è—Ü

‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ
- –ó–∞—Å—ã–ø–∞–Ω–∏–µ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç
- –ú–µ–¥–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ä—Ç –ø–æ—Å–ª–µ —Å–Ω–∞
```

### üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```
Basic Dyno: $7/–º–µ—Å—è—Ü
Heroku Postgres Essential: $5/–º–µ—Å—è—Ü
–ò–¢–û–ì–û: $12/–º–µ—Å—è—Ü

‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ù–µ –∑–∞—Å—ã–ø–∞–µ—Ç
- –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
```

### üöÄ –ü—Ä–æ–¥–∞–∫—à–µ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```
Standard-1X Dyno: $25/–º–µ—Å—è—Ü
Heroku Postgres Standard: $50/–º–µ—Å—è—Ü
Heroku Redis Mini: $3/–º–µ—Å—è—Ü
–ò–¢–û–ì–û: $78/–º–µ—Å—è—Ü

‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ê–≤—Ç–æ—Å–∫–µ–π–ª–∏–Ω–≥
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ë—ç–∫–∞–ø—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

## üõ†Ô∏è –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Postgres

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–¥–¥–æ–Ω–∞
```bash
heroku addons:create heroku-postgresql:essential-0 -a panenka-live
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
–ù—É–∂–Ω–æ –±—É–¥–µ—Ç:
- –î–æ–±–∞–≤–∏—Ç—å `psycopg2` –≤ `requirements.txt`
- –ò–∑–º–µ–Ω–∏—Ç—å `lobby_store.py` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ PostgreSQL
- –û–±–Ω–æ–≤–∏—Ç—å SQL –∑–∞–ø—Ä–æ—Å—ã (PostgreSQL —Å–∏–Ω—Ç–∞–∫—Å–∏—Å)

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# Heroku –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç DATABASE_URL
heroku config -a panenka-live | grep DATABASE_URL
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ dyno —á–∞—Å–æ–≤
heroku ps -a panenka-live

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
heroku logs --tail -a panenka-live

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã)
heroku logs --ps web -a panenka-live
```

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ–±–±–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–≥—Ä–æ–∫–æ–≤ –æ–Ω–ª–∞–π–Ω
- –ß–∞—Å—Ç–æ—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –ª–æ–±–±–∏
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API

## üéØ –í—ã–≤–æ–¥—ã

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–∏—Ç** (Eco dyno + SQLite)
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: $0/–º–µ—Å—è—Ü
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**: –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: Basic dyno + Postgres Essential
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: $12/–º–µ—Å—è—Ü
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å + –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è**: Standard dyno + Postgres Standard + Redis
- **–°—Ç–æ–∏–º–æ—Å—Ç—å**: $78/–º–µ—Å—è—Ü
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
